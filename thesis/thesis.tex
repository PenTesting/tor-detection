\documentclass{ecuthesis}

% For graphics
\usepackage{graphicx}

% Bibliography
\bibliography{fullrefs,websites,patents}

% Setup the variables for the title page
\title{Using traffic analysis to identify The Second Generation Onion Router}
\author{John Barker}
\department{School of Computer and Security Science}
\school{Edith Cowan University}
\degree{Computer Science (Honours)}
\email{jebarker@our.ecu.edu.au}
\studentid{0991300}
\supervisor{Dr Andrew Woodward}
\supervisor{Mr Peter Hannay}
\supervisor{Mr Patryk Szewczyk}

% Begin document
\begin{document}
\maketitle

\tableofcontents
\listoftables
\listoffigures

\begin{abstract}
\thispagestyle{empty}

Anonymous networks provide security for users by obfuscating messages with
encryption and hiding communications amongst cover traffic provided by other
network participants. The traditional goal of academic research into these
networks has been attacks that aim to uncover the identity of network users.
But the success of an anonymous network relies not only on it's technical
capabilities, but on adoption by a large enough user base to provide adequate
cover traffic. If anonymous network nodes can be identified, the users
can be harassed, discouraging participation. Tor is an example of widely used
anonymous network which uses a form of Onion Routing to provide low latency
anonymous communications. This paper demonstrates that traffic from a simulated
Tor network can be distinguished from regular encrypted traffic, suggesting that
real world Tor users may be vulnerable to the same analysis.

\end{abstract}

\chapter{Introduction}

\section{Background}

The first anonymous digital network, commonly known as MixNet was proposed in
\textcite{Chaum:1981p296}. The foundation of MixNet was the use of an
intermediary which forwarded messages from clients without any identifying
details. Numerous proposals and implementations followed such as Freedom
\parencite{Goldberg:1999p2231} and aChord \parencite{Hazel:2002p6929}. The
Second Generation Onion Router (Tor), is an anonymous network which uses a
variant of Onion Routing, to provide low latency anonymous communications to a
wide variety of Internet communications protocols
\parencite{Dingledine:2004p314}. It also aims to provide resistance against
censorship based blocking attempts \parencite{Dingledine:2008p1542}.

Tor was originally developed by the U.S. Naval Research Lab in 1997
\parencite{Syverson:1997kz} for application by the U.S. Navy. It has since been
adopted by The Tor Project, Inc. and is made publicly available, finding usage
in journalism, law enforcement, activism and military applications
\parencite{The-Tor-Project-Inc.:2011uq}. Tor is one of the most successful and
widely deployed anonymous networks, with an average of two hundred thousand
active users as of March 2011 \parencite{The-Tor-Project-Inc.:2011fk}.

Although Tor succeeds to a certain extent in providing anonymity and censorship
resistance. Under controlled conditions it is possible to distinguish Tor
traffic from other forms of encrypted traffic using traffic analysis. This makes
it easy for Tor users to be isolated and targeted for attack. Since Tor relies
on large numbers of users for the protections it provides, attacks that affect
the reliability of the network can discourage participation, making it
ineffective. This paper describes a simple traffic analysis technique which can
be used to distinguish Tor traffic from another form of commonly encrypted
traffic.

\section{Significance}

The Internet's expanding growth \parencite{Miniwatts-Marketing-Group:2010uq} and
role in political discourse \parencite{Bonchek:1997p3455} have allowed for
increased mobility and organization of activist groups
\parencite{Alexander:2011kx,Anderson:2011vn}. The increasingly sophisticated use
of censorship \parencite{Crandall:2007p6165,Karlin:2009p6166} and swift
retribution for dissenting opinion
\parencite{website:china-yahoo-torture,website:vietnam-bloggers-arrested,website:egypt-arrests,website:blogger-arrests}
may have chilling effects, effectively neutralizing these benefits. In light of
these threats the value of anonymous networks and anti-censorship technology can
be recognized. It is quite telling that new and sometimes unorthodox methods of
circumventing censorship are being deployed every day
\parencite{The-Economist:2011fk,Brading:2011ys}.

While Tor has been the subject of much academic literature, the primary
objective of researchers has historically been the attempt to reveal participant
identities \parencite[3]{Murdoch:2005p325}.  Many attack techniques proposed
have been somewhat academic in nature and not necessarily feasible in practice.
Sometimes they require compromise of large parts of the Tor network, supplying
hostile data to Tor users or complicated knowledge of usage patterns and an
excess of patience. The technique demonstrated in this paper is a low cost
technique, which does not require very sophisticated equipment and can be
completed by a passive observer.

\section{Research Questions}

Tor employs strong encryption, the goal of which is to ensure that the data
transmitted is indistinguishable from random noise. To an observer, two
different streams of encrypted data look almost the same. Thus the traditional
means of identifying these protocols are ineffective.

This raises the question: is it possible to distinguish the traffic created by
these networks, from encrypted traffic produced by conventional software? This
question can be broken down further:

\begin{enumerate*}
  \item Can the traffic be classified using automated matching techniques?
  \item Do these networks have characteristics that make them readily
    distinguishable using heuristics based matching?
  \item Do they have characteristics that make them distinguishable using
    machine learning techniques?
  %\item How long does a user have to be
  %  connected to the network before a confident match can be made?
\end{enumerate*}

\input litreview.tex

\chapter{Theoretical Framework}

\section{Research Methodology}

The experiment conducted in this paper utilize a non-equivalent group design.
The experimental groups are generated using simulations which allow for a great
deal of control over confounding variables, ensuring minimal difference between
the control and treatment groups. Both experiment groups perform the exact same
simulations. The control group performs all simulations using regular HTTPS,
while the treatment group proxies all communications over Tor. The treatment
group can be broken into HTTP over Tor and HTTPS over Tor based simulations.

\section{Assumptions}

It is assumed that the usage patterns exhibited by individual users will be
smaller than the communications characteristics that will lead to the
identification of anonymous and censorship resistant networks. Thus there is no
need to obtain a large sample of regular network traffic from varying user
profiles.

As of the current implementation, Tor network traffic is readily
distinguishable by looking at the handshake packets. It is likely that this
weakness will be addressed in a future version of the Tor protocol as it is
recognised as a design goal in \textcite{Dingledine:2008p1542}. For this
reason, this proposal focuses on traffic analysis techniques that are content
agnostic.

\section{Variables Impacting Research}

The data capturing stage will be affected by a number of variables that will
influence the accuracy of the chosen matching algorithms.

\subsection{Quality of the Anonymous Network}

An individual connection to the Tor network traverses a number of nodes to
create a circuit. The path a circuit uses is first defined by the exit node,
then chosen based on a number of constraints with a preference for high
bandwidth relays \parencite{website:tor-path-selection}. Since each connection
uses a different circuit and bandwidth demands are constantly changing, it is
difficult to predict the composition of a Tor circuit.

This means that any individual Tor circuit could be composed of systems with
differing capabilities, network throughput and configuration.

For this research, a simulated Tor network was constructed inside a virtual
machine. This allowed an identical configuration to be used across experimental
groups. Repeating the simulations and rolling back the Tor Network Guest to a
known snapshot ensured that each experiment group was composed of simulations
interacting with a Tor network of similar quality.

\subsection{System Performance}

The ability of a computer system to route packets in a timely fashion is highly
dependent on the performance of the system it is executing on. This is greatly
compounded by the usage of strong encryption which is computationally expensive.
Since packet latency is one of the key parameters used in traffic classification
techniques, it is important to isolate packet latency affects from confounding
variables. Components affecting packet latency include:

\begin{itemize*}
  \item CPU speed and number of cores
  \item RAM speed and capacity
  \item Performance of integrated components, system bus etc.
  \item Hard disk size, access time and throughput
  \item Installed and running applications
  \item System configuration
\end{itemize*}

In addition it is noted that system performance can degrade over time due to
both memory and hard disk fragmentation. The affects of these variables was
mitigated by periodically rolling back virtual machine snapshots to return to a
known system state and using the same network and computer hardware for all
simulations.

\subsection{Network Performance}

Like system performance, latency is also dependent on the quality of the
network. Network switching equipment has limited resources for routing packets
and competing network traffic can introduce congestion which would radically
alter the observable communications patterns \parencite{Jacobson:1995p6768}.
Tor also supports congestion mitigation techniques which alter communication
patterns \parencite[8]{Dingledine:2004p314}.

Latency and network performance over the Internet are highly variable and
beyond the control of any one individual. Usage patterns vary according to
geographic region, societal conventions and the period in which they occur
\parencite{Thompson97wide-areainternet,Ken03longitudinalstudy}. The Internet,
and by necessity the public Tor network are globally distributed, which means
that circuits traverse a large variety of unpredictable network conditions.

The experiment utilized an isolated test network, with unrelated network
processes disabled ensuring no interference or congestion.

\subsection{Application Protocol}

Tor provides communications facilities to a number of Internet enabled
applications by providing an interface using the SOCKS protocol
\parencite[17]{Dingledine:2004p314}. This means that the Tor network can proxy
regular web browsing, email or any other TCP or UDP based communication protocol
\parencite{website:socks}. Each of these application protocols have their own
distinguishing communications characteristics which may influence the matching
algorithm.

For the purpose of this experiment, the protocol chosen was the HTTPS protocol.
The treatment group was split into two components, the first part using HTTP
over Tor and the second using HTTPS over Tor.

\subsection{Caching}

Both web browsers and web servers are designed for high performance and often
cache requests so that they can be delivered faster in the future
\parencite{Caceres:1998p7419}. While this is a normal part of communications
traffic and should be considered, it is important that both regular and cached
requests appear uniformly across all experiments.

Periodically rolling back virtual machine snapshots during the experiment
ensures that the browser cache always begins at empty for a series of
simulations.

\input experiment.tex

\input results.tex

\chapter{Appendix}

\section{Manager Script}

\label{manager-script}
\lstinputlisting[language=ruby]{../experiment/simulation/manager/run_simulation.rb}

\section{Client Script}

\label{client-script}
\lstinputlisting[language=ruby]{../experiment/simulation/client/client.rb}

\section{Generate Tor Network Script}

\label{generate-tor-network-script}
\lstinputlisting[language=sh]{../experiment/simulation/tor/make_private_network.sh}

\section{Run Tor Network Script}

\label{run-tor-network-script}
\lstinputlisting[language=sh]{../experiment/simulation/tor/run_private_network.sh}

\printbibliography[title=REFERENCES]

\end{document}

% vim: fdm=syntax tw=80
