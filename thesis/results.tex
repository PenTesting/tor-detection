\chapter{Results}

\section{Results}

Traffic classification algorithms are evaluated using a number of metrics, the
primary of these being the true positive rate sometimes known as the detection
rate (DR) and the false positive rate. A strong traffic classifier typically
has a high true positive rate and a low false positive rate. In table
\ref{table:results} the true positive rate indicates the percentage of
individual sessions correctly classified as the listed protocol. The false
positive rate indicates the percentage of sessions incorrectly labelled as the
listed protocol. Included with these is the area under the receiver operating
characteristic (ROC) curve. The ROC is a tool used for evaluating the
usefulness and comparing different matching algorithms and is often used to
compare Internet traffic classification techniques
\parencite{citeulike:167557,Nguyen:2008p3837}.

All of the algorithms chosen were able to successfully classify HTTPS and HTTP
over Tor traffic with accuracy in excess of 90\%, with the Adaboost algorithm
unable to classify HTTPS over Tor. The best performing algorithm random forest
was able to classify HTTP over Tor with 93.7\% accuracy and a false positive
rate of 3.7\%. HTTPS over Tor was more easily identified with a 97.7\% accuracy
and low false positive rate of 0.3\%.

\begin{table}[H]
  \begin{tabular}{lrrr}
    \toprule
    & True Positive Rate & False Positive Rate & ROC Area \\
    \midrule
    Random Forest\\
    \midrule
    HTTPS & 0.957 & 0.036 & 0.99\\
    HTTP over Tor & 0.937 & 0.037 & 0.986\\
    HTTPS over Tor & 0.977 & 0.003 & 0.999\\
    Weighted Avg. & 0.954 & 0.03 & 0.99\\
    \midrule
    j4.8 With 10 fold cross validation\\
    \midrule
    HTTPS & 0.951 & 0.04 & 0.989\\
    HTTP over Tor & 0.978 & 0.043 & 0.98\\
    HTTPS over Tor & 0.97 & 0.007 & 0.992\\
    Weighted Avg. & 0.964 & 0.018 & 0.986\\
    \midrule
    Random Tree\\
    \midrule
    HTTPS & 0.961 & 0.046 & 0.963\\
    HTTP over Tor & 0.906 & 0.04 & 0.94\\
    HTTPS over Tor & 0.955 & 0.01 & 0.972\\
    Weighted Avg. & 0.941 & 0.037 & 0.957\\
    \midrule
    Adaboost\\
    \midrule
    HTTPS & 0.95 & 0.001 & 0.975\\
    HTTP over Tor & 0.999 & 0.324 & 0.838\\
    HTTPS over Tor & 0 & 0 & 0.777\\
    Weighted Avg. & 0.785 & 0.109 & 0.891\\
    \bottomrule
  \end{tabular}
  \caption{Results}
  \label{table:results}
\end{table}

\chapter{Discussion of Results}

\section{Limitations}

The classifiers developed within this experiment have been trained against
a relatively small sample set of simulated data, which may only represent
a small fraction of the width and breadth of conditions available on a wider
area network. The characteristics that allow for classification of Tor network
may be masked by the natural variability introduced by a heterogeneous network.

The real Tor network consists of over two hundred thousand computer systems,
with over two thousand routers \parencite{TorStatus:2011fk}, all with different
operating systems, different hardware, different configurations and available
bandwidth. All the variables that were controlled for during this experiment
are present in the real network, and may be amplified by it's greater size.
Without further research it is difficult to say if the technique demonstrated
here will apply in the wild.

\section{Addressing Research Questions}

\begin{enumerate*}
  \item{Can Tor traffic be distinguished from other network traffic that uses
    similar or the same encryption and protocols?}

    Under the controlled conditions of the experiment demonstrated within this
    thesis, comparing a sample of simulated encrypted network traffic produced
    by a commonly used web browser versus the same traffic routed over a
    demonstration Tor network, all the techniques used were able to classify
    Tor traffic with a high level of accuracy.

  \item{Can Tor traffic be identified using automated matching techniques?}

    All the classification algorithms trialled were able to successfully classify
    web browser traffic routed over the simulated Tor network, with the best
    performing algorithm able to correctly classify 95\%.

    The value of this level of accuracy depends on the application. Identifying
    multiple regular connections to the Tor network may provide sufficient
    confidence to classify a system as a Tor node. This could be combined with
    other known properties of the Tor network to increase confidence.

  \item{Does Tor traffic have characteristics that make it readily distinguishable using
    heuristics based matching?}



\end{enumerate*}


\section{Possible Implications of Results}

The research results suggest that the strategies used by anonymous networks to
hide the identity of network participants, may make those anonymous networks
more easy to distinguish from networks and software that do not provide any
anonymity.

Research has shown that the low latency design of Tor means it is vulnerable to
traffic analysis attacks that correlate traffic patterns with users. This
vulnerability is indicative of the subtle amount of overhead incurred when
sending traffic through Tor. This should make it difficult to identify whether a
connection is using Tor VS not using Tor, though it is clearly still possible.
Reducing this overhead further may reduce the success of Tor traffic
identification.

Stronger anonymity providing networks utilize more sophisticated techniques to
hide individual identities such as batching, queuing and normalization. While
they may be more resistant to identity uncovering attacks, this may also make
them more easily identifiable by classification techniques.


\chapter{Conclusion}

\section{Conclusion}

Using Tor as a communications proxy incurs some overhead, sufficient enough that
when using a Tor proxy in controlled conditions, Tor traffic can be
distinguished from regularly encrypted traffic. This overhead may be sufficient
enough that Tor nodes in a real world network can be identified by using readily
available eavesdropping techniques.

However, this experiment was based on a small set of simulated data, with which
it would be impossible to cover all the possible real world conditions. The
variability present in the real Tor network may make this classification
technique impossible. Further research needs to be conducted with live packet
traces from real participants in the Tor network.
